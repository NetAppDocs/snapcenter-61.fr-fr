---
permalink: protect-sco/task_clone_a_pluggable_database.html 
sidebar: sidebar 
keywords: clone, pluggable database, PDB 
summary: 'Vous pouvez cloner une base de données enfichable (PDB) vers une CDB cible différente ou identique sur le même hôte ou un hôte alternatif.  Vous pouvez également récupérer le PDB cloné vers un SCN ou une date et une heure souhaités.' 
---
= Cloner une base de données enfichable
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
Vous pouvez cloner une base de données enfichable (PDB) vers une CDB cible différente ou identique sur le même hôte ou un hôte alternatif.  Vous pouvez également récupérer le PDB cloné vers un SCN ou une date et une heure souhaités.

*Avant de commencer*

Si vous avez installé le plug-in en tant qu'utilisateur non root, vous devez attribuer manuellement les autorisations d'exécution aux répertoires prescript et postscript.

*Mesures*

. Dans le volet de navigation de gauche, cliquez sur *Ressources*, puis sélectionnez le plug-in approprié dans la liste.
. Dans la page Ressources, sélectionnez *Base de données* ou *Groupe de ressources* dans la liste *Affichage*.
. Sélectionnez la base de données de type instance unique (multilocataire) à partir de la vue des détails de la base de données ou à partir de la vue des détails du groupe de ressources.
+
La page de topologie de la base de données s'affiche.

. Dans la vue Gérer les copies, sélectionnez les sauvegardes parmi les copies locales (principales), les copies miroir (secondaires) ou les copies Vault (secondaires).
. Sélectionnez la sauvegarde dans le tableau, puis cliquez sur *image:../media/clone_icon.gif["icône de clonage"] *.
. Dans la page Nom, effectuez les actions suivantes :
+
.. Sélectionnez *PDB Clone*.
.. Spécifiez le PDB que vous souhaitez cloner.
+

NOTE: Vous ne pouvez cloner qu'un seul PDB à la fois.

.. Spécifiez le nom du PDB clone.


. Dans la page Emplacements, effectuez les actions suivantes :
+
|===


| Pour ce domaine... | Fais ceci... 


 a| 
Hôte clone
 a| 
Par défaut, l'hôte de la base de données source est renseigné.

Si vous souhaitez créer le clone sur un autre hôte, sélectionnez l'hôte ayant la même version d'Oracle et du même système d'exploitation que celui de l'hôte de la base de données source.



 a| 
Cible CDB
 a| 
Sélectionnez la CDB dans laquelle vous souhaitez inclure le PDB cloné.

Vous devez vous assurer que la CDB cible est en cours d’exécution.



 a| 
État de la base de données
 a| 
Cochez la case *Ouvrir le PDB cloné en mode LECTURE-ÉCRITURE* si vous souhaitez ouvrir le PDB en mode LECTURE-ÉCRITURE.



 a| 
Emplacements des fichiers de données
 a| 
Par défaut, l'emplacement du fichier de données est renseigné.

La convention de dénomination par défaut de SnapCenter pour les systèmes de fichiers SAN ou NFS est FileSystemNameofsourcedatabase_SCJOBID.

La convention de dénomination par défaut de SnapCenter pour les groupes de disques ASM est SC_HASHCODEofDISKGROUP_SCJOBID.  Le HASHCODEofDISKGROUP est un numéro généré automatiquement (2 à 10 chiffres) qui est unique pour chaque groupe de disques ASM.


NOTE: Si vous personnalisez le nom du groupe de disques ASM, assurez-vous que la longueur du nom respecte la longueur maximale prise en charge par Oracle.

Si vous souhaitez spécifier un chemin différent, vous devez saisir les points de montage du fichier de données ou les noms des groupes de disques ASM pour la base de données clonée.

|===
+
Les détails de la page d'accueil Oracle, du nom d'utilisateur et du groupe sont automatiquement renseignés à partir de la base de données source.  Vous pouvez modifier les valeurs en fonction de l’environnement Oracle de l’hôte sur lequel le clone sera créé.

. Dans la page PreOps, effectuez les étapes suivantes :
+
.. Entrez le chemin et les arguments du prescript que vous souhaitez exécuter avant l'opération de clonage.
+
Vous devez stocker le prescript soit dans /var/opt/snapcenter/spl/scripts, soit dans n'importe quel dossier à l'intérieur de ce chemin.  Par défaut, le chemin /var/opt/snapcenter/spl/scripts est renseigné.  Si vous avez placé le script dans un dossier à l'intérieur de ce chemin, vous devez fournir le chemin complet jusqu'au dossier où le script est placé.

+
SnapCenter vous permet d'utiliser les variables d'environnement prédéfinies lorsque vous exécutez le prescript et le postscript.link:../protect-sco/predefined-environment-variables-prescript-postscript-clone.html["Apprendre encore plus"^]

.. Dans la section Paramètres de la base de données de clone CDB auxiliaire, modifiez les valeurs des paramètres de base de données préremplis utilisés pour initialiser la base de données.


. Cliquez sur *Réinitialiser* pour obtenir les paramètres de base de données par défaut.
. Dans la page PostOps, *Jusqu'à annuler* est sélectionné par défaut pour effectuer la récupération de la base de données clonée.
+
L'option *Jusqu'à annulation* n'est pas sélectionnée si SnapCenter ne parvient pas à trouver les sauvegardes de journaux appropriées.  Vous pouvez fournir l'emplacement du journal d'archive externe si la sauvegarde du journal n'est pas disponible dans *Spécifier les emplacements du journal d'archive externe*.  Vous pouvez spécifier plusieurs emplacements de journaux.

+

NOTE: Si vous souhaitez cloner une base de données source configurée pour prendre en charge la zone de récupération flash (FRA) et Oracle Managed Files (OMF), la destination du journal pour la récupération doit également respecter la structure du répertoire OMF.

+
|===
| Nom du champ | Description 


 a| 
Jusqu'à l'annulation
 a| 
SnapCenter effectue la récupération en montant la dernière sauvegarde du journal contenant la séquence ininterrompue des journaux d'archive après cette sauvegarde de données sélectionnée pour le clonage.

La sauvegarde du journal et des données doit être effectuée sur le stockage principal pour effectuer le clonage sur le stockage principal et la sauvegarde du journal et des données doit être effectuée sur le stockage secondaire pour effectuer le clonage sur le stockage secondaire.  La base de données clonée est récupérée jusqu'au fichier journal manquant ou corrompu.



 a| 
Date et heure
 a| 
SnapCenter récupère la base de données jusqu'à une date et une heure spécifiées.


NOTE: L'heure peut être spécifiée au format 24 heures.



 a| 
Jusqu'au SCN (System Change Number)
 a| 
SnapCenter récupère la base de données jusqu'à un numéro de modification système (SCN) spécifié.



 a| 
Spécifier les emplacements des journaux d'archives externes
 a| 
Spécifiez l’emplacement du journal d’archive externe.



 a| 
Créer un nouveau DBID
 a| 
Par défaut, la case à cocher *Créer un nouveau DBID* n'est pas sélectionnée pour la base de données clone auxiliaire.

Cochez la case si vous souhaitez générer un numéro unique (DBID) pour la base de données auxiliaire clonée, la différenciant de la base de données source.



 a| 
Créer un fichier temporaire pour l'espace table temporaire
 a| 
Cochez la case si vous souhaitez créer un fichier temporaire pour l’espace table temporaire par défaut de la base de données clonée.

Si la case à cocher n'est pas sélectionnée, le clone de base de données sera créé sans le fichier temporaire.



 a| 
Saisissez les entrées SQL à appliquer lors de la création du clone
 a| 
Ajoutez les entrées SQL que vous souhaitez appliquer lors de la création du clone.



 a| 
Entrez les scripts à exécuter après l'opération de clonage
 a| 
Spécifiez le chemin et les arguments du postscript que vous souhaitez exécuter après l'opération de clonage.

Vous devez stocker le postscript soit dans _/var/opt/snapcenter/spl/scripts_ soit dans n'importe quel dossier à l'intérieur de ce chemin.

Par défaut, le chemin _/var/opt/snapcenter/spl/scripts_ est renseigné.  Si vous avez placé le script dans un dossier à l'intérieur de ce chemin, vous devez fournir le chemin complet jusqu'au dossier où le script est placé.


NOTE: Si l'opération de clonage échoue, les postscripts ne seront pas exécutés et les activités de nettoyage seront déclenchées directement.

|===
. Dans la page Notification, dans la liste déroulante *Préférence de courrier électronique*, sélectionnez les scénarios dans lesquels vous souhaitez envoyer les courriers électroniques.
+
Vous devez également spécifier les adresses e-mail de l'expéditeur et du destinataire, ainsi que l'objet de l'e-mail.  Si vous souhaitez joindre le rapport de l'opération de clonage effectuée, sélectionnez *Joindre le rapport de travail*.

+

NOTE: Pour la notification par e-mail, vous devez avoir spécifié les détails du serveur SMTP à l’aide de l’interface graphique ou de la commande PowerShell Set-SmSmtpServer.

. Consultez le résumé, puis cliquez sur *Terminer*.
. Surveillez la progression de l'opération en cliquant sur *Surveiller* > *Tâches*.


*Après avoir fini*

Si vous souhaitez créer une sauvegarde du PDB cloné, vous devez sauvegarder le CDB cible où le PDB est cloné, car la sauvegarde uniquement du PDB cloné n'est pas possible.  Vous devez créer une relation secondaire pour la CDB cible si vous souhaitez créer la sauvegarde avec une relation secondaire.

Dans une configuration RAC, le stockage du PDB cloné est attaché uniquement au nœud sur lequel le clonage du PDB a été effectué.  Les PDB sur les autres nœuds du RAC sont dans l’état MOUNT.  Si vous souhaitez que le PDB cloné soit accessible à partir des autres nœuds, vous devez attacher manuellement le stockage aux autres nœuds.

*Trouver plus d'informations*

* https://kb.netapp.com/Advice_and_Troubleshooting/Data_Protection_and_Security/SnapCenter/ORA-00308%3A_cannot_open_archived_log_ORA_LOG_arch1_123_456789012.arc["La restauration ou le clonage échoue avec le message d'erreur ORA-00308"^]
* https://kb.netapp.com/Advice_and_Troubleshooting/Data_Protection_and_Security/SnapCenter/What_are_the_customizable_parameters_for_backup_restore_and_clone_operations_on_AIX_systems["Paramètres personnalisables pour les opérations de sauvegarde, de restauration et de clonage sur les systèmes AIX"^]

